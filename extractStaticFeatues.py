from utils import extract_exe_info
from utils import fromFilePaths
from utils import seperate_path_filename
from joblib import Parallel, delayed
from utils import WriteDictToCSV, columns_
import os

infected_folder = 'infected/'
data = []

def func(filename, source_path, val):
    data.append(extract_exe_info(source_path + filename, mal = val))

info = Parallel(n_jobs=-1, verbose=1, backend='threading')(delayed(func)(index, infected_folder, 1) for index in os.listdir(infected_folder))

non_infected_exe = fromFilePaths('All_exe_d_folder.txt')

goodware_paths = []
goodware_filename = []
seperate_path_filename(non_infected_exe, goodware_paths, goodware_filename)

info = Parallel(n_jobs=-1, verbose=1, backend='threading')(delayed(func)(goodware_filename[index], goodware_paths[index], 0) for index in range(0, len(goodware_paths)))

WriteDictToCSV(columns_, data, 'Static_Data.csv', 0)